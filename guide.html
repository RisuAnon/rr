<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RisuAI 시각효과 플러그인 긴급 수정 북마클릿 설치</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; padding: 20px; max-width: 800px; margin: auto; }
        .code-block { background-color: #f0f0f0; padding: 15px; border-radius: 5px; overflow-x: auto; word-wrap: break-word; white-space: pre-wrap; margin-bottom: 10px; font-family: monospace; }
        button { padding: 10px 15px; cursor: pointer; font-size: 1em; margin-bottom: 20px; }
        .instructions { border: 1px solid #ccc; padding: 15px; margin-top: 20px; }
        .instructions h3 { margin-top: 0; }
        .instructions ul { padding-left: 20px; }
        .instructions li { margin-bottom: 10px; }
         /* 모바일에서 코드 복사 버튼 잘 보이도록 */
        @media (max-width: 600px) {
            button { width: 100%; }
        }
    </style>
</head>
<body>

    <h1>RisuAI 시각효과 플러그인 긴급 수정 북마클릿</h1>
    <p><strong>문제:</strong> 특정 환경(주로 Firefox)에서 '시각효과' 플러그인이 활성화된 상태로 플러그인 설정 UI에 접근하면 브라우저가 멈추는(프리징) 현상이 발생합니다.</p>
    <p><strong>해결:</strong> 이 북마클릿은 문제의 원인이 되는 기능을 일시적으로 비활성화하여 플러그인 설정 UI에 안전하게 접근할 수 있도록 돕습니다. 플러그인을 비활성화하거나 업데이트하기 위한 임시 조치입니다.</p>

    <h2>1. 북마클릿 코드 복사</h2>
    <p>아래 버튼을 눌러 북마클릿 코드를 복사하세요.</p>
    <pre id="bookmarklet-code" class="code-block"><code>javascript:(function(){try{if(!window.originalMutationObserverObserve){window.originalMutationObserverObserve=MutationObserver.prototype.observe;console.log('Observer backup.')}MutationObserver.prototype.observe=function(t,o){if(t===document.body){console.warn('[Bookmarklet] Blocking body observer.')}else{window.originalMutationObserverObserve.call(this,t,o)}};console.log('[Bookmarklet] Observer intercept applied.');alert('[임시 조치 완료]\n\nObserver 가로채기가 적용되었습니다.\n\n1. 페이지를 새로고침 하세요.\n2. 새로고침 후 이 북마클릿을 다시 실행하세요.\n3. 플러그인 설정 UI로 이동하여 플러그인을 비활성화/업데이트 하세요.')}catch(e){console.error('[Bookmarklet Error]',e);alert('[오류]\n\n임시 조치 적용 중 오류:\n'+e.message);if(window.originalMutationObserverObserve){MutationObserver.prototype.observe=window.originalMutationObserverObserve;console.log('Observer restored due to error.')}}})();</code></pre>
    <button onclick="copyCode()">북마클릿 코드 복사</button>
    <p id="copy-status" style="font-weight: bold;"></p>

    <h2>2. 브라우저에 북마클릿 추가</h2>
    <p>복사한 코드를 사용하여 브라우저에 새 북마크(즐겨찾기)를 추가해야 합니다. 아래에서 사용 중인 환경에 맞는 안내를 따르세요.</p>


     <div class="instructions">
        <h3>PC (Chrome / Firefox / Edge 등)</h3>
        <p>가장 쉬운 방법은 위 코드 블록 위의 '북마클릿 코드 복사' 버튼 왼쪽의 북마크 아이콘(만약 있다면)이나, 아래 텍스트 링크를 **북마크바로 드래그 앤 드롭**하는 것입니다.</p>
        <p><a href="javascript:(function(){try{if(!window.originalMutationObserverObserve){window.originalMutationObserverObserve=MutationObserver.prototype.observe;console.log('Observer backup.')}MutationObserver.prototype.observe=function(t,o){if(t===document.body){console.warn('[Bookmarklet] Blocking body observer.')}else{window.originalMutationObserverObserve.call(this,t,o)}};console.log('[Bookmarklet] Observer intercept applied.');alert('[임시 조치 완료]\n\nObserver 가로채기가 적용되었습니다.\n\n1. 페이지를 새로고침 하세요.\n2. 새로고침 후 이 북마클릿을 다시 실행하세요.\n3. 플러그인 설정 UI로 이동하여 플러그인을 비활성화/업데이트 하세요.')}catch(e){console.error('[Bookmarklet Error]',e);alert('[오류]\n\n임시 조치 적용 중 오류:\n'+e.message);if(window.originalMutationObserverObserve){MutationObserver.prototype.observe=window.originalMutationObserverObserve;console.log('Observer restored due to error.')}}})();">RisuAI 긴급 수정 (이 링크를 북마크바로 드래그)</a></p>
        <p>또는, 수동으로 북마크를 추가하고 이름과 주소(URL)를 위 코드로 입력해도 됩니다.</p>
    </div>

    <h2>3. 북마클릿 사용 방법</h2>
     <ol>
        <li>RisuAI 페이지를 엽니다.</li>
        <li>페이지 로드가 완료된 후, <strong>추가한 북마클릿을 클릭(탭)합니다.</strong> `[임시 조치 완료]` 알림창이 뜹니다.</li>
        <li>페이지를 <strong>새로고침</strong> 합니다.</li>
        <li>새로고침 후, <strong>리스가 로딩되는 중일때 다시 한번 북마클릿을 클릭(탭)합니다.</strong></li>
        <li>( 소리 및 디스플레이 > 기타 > Show Saving Icon 옵션에 체크하면 플러그인 제거 후 제대로 저장되었는지 확인할 수 있습니다. 디스켓 아이콘이 우측 상단에 등장했다가 사라질때까지 기다리세요 )</li>
        <li>이제 플러그인 설정 UI로 이동하여 플러그인을 제거하세요.</li>
    </ol>

    <script>
        function copyCode() {
            const codeElement = document.getElementById('bookmarklet-code');
            const code = codeElement.textContent || codeElement.innerText; // Get the text content
            const statusElement = document.getElementById('copy-status');

            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(code).then(function() {
                    /* clipboard successfully set */
                    statusElement.textContent = '코드가 클립보드에 복사되었습니다!';
                    statusElement.style.color = 'green';
                     setTimeout(() => { statusElement.textContent = ''; }, 3000); // Hide after 3 seconds
                }, function() {
                    /* clipboard write failed */
                    statusElement.textContent = '코드 복사에 실패했습니다. 직접 복사해주세요.';
                    statusElement.style.color = 'red';
                });
            } else {
                // Fallback for older browsers (less reliable)
                try {
                    const textArea = document.createElement("textarea");
                    textArea.value = code;
                    textArea.style.position = "fixed"; //avoid scrolling to bottom
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    statusElement.textContent = '코드가 클립보드에 복사되었습니다! (Fallback)';
                     statusElement.style.color = 'green';
                     setTimeout(() => { statusElement.textContent = ''; }, 3000);
                } catch (err) {
                    statusElement.textContent = '코드 복사에 실패했습니다. 직접 복사해주세요. (Fallback failed)';
                     statusElement.style.color = 'red';
                     console.error('Fallback Copy Error:', err);
                }
            }
        }
    </script>

</body>
</html>